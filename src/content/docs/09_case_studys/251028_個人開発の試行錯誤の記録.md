---
title: 個人開発の試行錯誤の記録
---

環境構築をする
Github Actionsを使ってみる
ECSにCI/CDパイプラインを作れればいいかなと思う
ECSはCloud Runのようなものかと思っていたが、常時稼働で意外とコストがかさむことに気づく
AWSは技術記事を書くために1日だけリソースを作って壊す、というやり方に切り替える
まずはローカルで開発する

まずはUIを作れば具体化できるのではないかと思い、UIを作り始める
紙にUIのイメージ図を書いて、写真を撮り、ChatGPTにUIの実装をお願いして、手元でそれを再現することで見てみようと思う
ファイル数が多くて挫折する
ディレクトリ丸ごとzipで出してもらえばいいと気づいてそう
プレビューモードがあることを知る

ChatGPTに要件定義書の構成を考えてもらう

構成に沿って内容を埋めていく

Claudeにブラッシュアップを依頼する

壁打ちしてブラッシュアップしていく

量が多くなったため、要件定義書から設計書部分を切り出す

Claudeが出してくれた画面設計書をよく見て、修正をする

- とても細かくて骨が折れた

紙にUIを書いてAIにコード化してもらうのではなく、mdファイルにUIを書いてAIにコード化してもらうやり方があることを知る

プロジェクトディレクトリでVSCodeのウィンドウを開く

```bash
cd ~/projects/AI-study_quote-collector
code . # このディレクトリを最上位層として、VSCodeのウィンドウが新たに開かれる
```

Claude Codeを初期化する

```bash
claude /init
```

これにより、ルートに CLAUDE.md が作成されます。
このファイルに「Claudeへの指示（プロジェクト説明・参照ドキュメントなど）」を書くと、Claudeが文脈を理解して行動してくれるようになります。

CLAUDE.mdに既に英語で説明が書かれているが、末尾に日本語で以下を追記する。

```markdown
# CLAUDE.md

## プロジェクト概要
抜き書きアプリ「AI-study_quote-collector」。
本・SNSから印象に残ったフレーズを保存・分類・検索できるWebアプリ。

### 技術スタック
- Frontend: Next.js / TypeScript / React
- Backend: FastAPI (Python)
- Database: PostgreSQL (Supabase)
- Docs: `/docs` フォルダに設計書あり

### Claudeへの指示
- コードを書くときは `/docs` 内の最新版設計書（_v2.md）を参照
- 質問されたらまず設計書をもとに整合性を確認してから提案
- ファイル編集時はフォーマット（Prettier, Ruff）に合わせる
- 命名は英語（snake_case or camelCase）で統一
```

Claude Codeのコマンドラインに以下を入力する。

```txt
今後の回答は日本語でお願いします。
```

→Claude Codeが日本語で答えてくれるようになる！

要件定義書、各種設計書をひとつずつ読み込ませる。

```txt
docs/要件定義書_v2.md を読んで、この内容を覚えておいて。
```

→ Claude Codeが目を通して咀嚼・要約し、内容に基づいて動いてくれるようになる。

```bash
● Read(docs/画面設計書_実装版_v2.md)
⎿  Read 406 lines

...

I'm now familiar with these requirements and will reference them when working on implementation tasks. Let me know what you'd like to work on!
```

プロジェクトがほぼ初期状態ですね。設計ドキュメントは完璧に揃っているので、これから実装を進める形になります。

  以下の順序で進めるのがおすすめです：

  推奨する実装順序

  Phase 1: 基盤構築（最優先）

  1. プロジェクト初期化
    - Next.js 14 プロジェクトのセットアップ
    - TypeScript、Tailwind CSS、必要なパッケージのインストール
    - ESLint、Prettier の設定
  2. Supabase セットアップ
    - データベーススキーマの作成（マイグレーション）
    - RLS ポリシーの設定
    - 認証プロバイダーの有効化
  3. 認証システム
    - Supabase クライアント（client.ts, server.ts）
    - middleware.ts（認証チェック）
    - ログイン画面

  Phase 2: コア機能（MVP）

  4. 基本レイアウト
    - メインレイアウト（ヘッダー、ナビゲーション）
    - ダークテーマのスタイリング
  5. フレーズ一覧表示（ホーム画面）
    - GET /api/quotes/grouped の実装
    - グループ化表示（書籍/SNS単位）
    - 基本的なUI
  6. フレーズ登録（テキスト入力）
    - POST /api/quotes の実装
    - 登録モーダル（アコーディオンUI）
    - 活動領域・タグ選択
  7. 活動領域・タグAPI
    - GET /api/activities
    - GET /api/tags, POST /api/tags

  Phase 3: 検索・フィルター

  8. 検索・フィルター機能
    - キーワード検索
    - 活動領域フィルター
    - タグフィルター

  Phase 4: 拡張機能

  9. 書籍・SNS管理
    - Amazon書籍情報取得API
    - SNSユーザー情報取得API
  10. OCR機能
    - Tesseract.js 統合
    - 画像アップロード・選択UI
  11. その他の機能
    - タグ管理画面（統合・削除）
    - CSV エクスポート

  ---
  最初のステップの提案

  今から始めるなら、Phase 1の「プロジェクト初期化」から始めましょう。

  具体的には：

# Next.js プロジェクトの初期化

# 必要なパッケージのインストール

# 基本的なディレクトリ構造の作成

package.jsonを作成する（Next.jsプロジェクトの初期設定）

tsconfig.jsonを作成する（TypeScript設定ファイルの作成）

next.config.jsを作成する（Next.js設定ファイルの作成）
Amazon画像とSupabase画像の最適化設定を含む

Tailwind CSS設定ファイルの作成
tailwind.config.ts

PostCSS設定ファイルの作成
postcss.config.mjs

ESLint設定ファイルの作成
.eslintrc.json

Prettier設定ファイルの作成
.prettierrc

.gitignoreを更新
以下を追記

```
# === Lock files (keep them for consistency) ===
# Uncomment if you want to exclude lock files
# package-lock.json
# pnpm-lock.yaml
# yarn.lock
```

npm installをする
package.jsonに記載されたライブラリがインストールされる

基本ディレクトリ構造の作成

```bash
mkdir -p app/{"\(auth\)"/{login,callback},"\(main\)"/{settings/tags,components},api/{activities,books,sns-users,tags,quotes,ocr,export}}
   lib/{supabase,ocr,scraping,utils} components/{ui,layouts} public/assets styles types
```

```bash
tree -L 3 -I 'node_modules|.next' .
```

なぜ -I 'node_modules|.next' を付けるのか？

node_modules/ や .next/ は自動生成フォルダで、
中身が非常に多くて重要ではない ため、見ても意味がない。

それらを除外して、自分が管理しているソース構成だけをスッキリ表示する目的です。

| 部分                | 意味                                                                           |                                                                        |                    |
| ----------------- | ---------------------------------------------------------------------------- | ---------------------------------------------------------------------- | ------------------ |
| `tree`            | ディレクトリ構造をツリー（木）状に表示するコマンド。                                                   |                                                                        |                    |
| `-L 3`            | 階層の深さを **3階層まで** 表示する。例：<br> `.` → `src/` → `components/` → `Button.tsx` まで。 |                                                                        |                    |
| `-I 'node_modules | .next'`                                                                      | **除外するディレクトリやファイルを指定**。<br>ここでは `node_modules` と `.next` を表示しない。<br>（` | ` は「または」を意味する正規表現） |
| `.`               | 現在のディレクトリを対象にする。                                                             |                                                                        |                    |

環境変数サンプルファイルの作成
.env.example

グローバルスタイルの作成
styles/globals.css

ルートレイアウトの作成
Next.js 14のApp Routerには、ルートレイアウトが必要です
app/layout.tsx

動作確認用の簡単なホームページの作成
app/page.tsx
スクショ

次は以下のどれかを進められます：

1. Supabaseのセットアップ - データベーススキーマの作成
2. 認証システムの実装 - ログイン機能
3. 基本的なAPI実装 - 活動領域APIなど

→①を選択

承知しました！Supabaseのセットアップを進めましょう。

  Supabaseセットアップ - ステップバイステップ

  ステップ1: Supabaseプロジェクトの作成確認

  まず、Supabaseプロジェクトはもう作成済みですか？

- 作成済みの場合 → プロジェクトのURLとAnon Keyを教えてください
- 未作成の場合 → これから <https://supabase.com> でプロジェクトを作成する手順を説明します

  どちらですか？

  それまでの間に、ローカルでのSupabase開発環境のセットアップを進めます。

  ステップ2: Supabase CLIのインストール（オプション）

  ローカルでSupabaseを使う場合、Supabase CLIが便利です。インストールしますか？

● Bash(which supabase)
  ⎿  Error: Error

● Supabase CLIは未インストールですね。まずは必要なファイルを作成していきましょう。

  ステップ3: Supabaseクライアントの作成

  技術仕様書に基づいて、Supabaseクライアントを作成します。

  3-1: ブラウザ用クライアント（client.ts）

● Write(lib/supabase/client.ts)

Write(lib/supabase/server.ts)
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Opened changes in Visual Studio Code ⧉

3-3: データベース型定義（types.ts）

● Write(lib/supabase/types.ts)

ステップ4: データベースマイグレーションSQLの作成

  データベース設計書に基づいて、完全なスキーマ定義を作成します。

mkdir -p supabase/migrations

Write(supabase/migrations/20241027000000_initial_schema.sql)

ステップ5: Supabaseセットアップ手順書の作成

● Write(supabase/README.md)

ステップ6: 認証ミドルウェアの作成

  技術仕様書に基づいて、認証チェック用のミドルウェアを作成します：

● Write(middleware.ts)

ステップ7: プロジェクトREADMEの作成

● Write(README.md)

10/29

- 手順書に沿った作業
- Supabaseのアカウント作成
- プロジェクト作成
- APIキーを.envに転記
- マイグレーションファイルの内容を実行してテーブル作成、データの移行
- GoogleCloudOAuthクライアント作成
![alt text](/_articles/images/imgs/GoogleCloudOAuthクライアント作成.png)
- GoogleCloudOAuthクライアントの情報をSupabaseのAuthentication > ProvidersGoogleに登録
JSONでダウンロード
- 同様にGithubも登録
  - Client ID: Ov23lixJyRrArN7lSuMS
  - Client secrets: ad3bdcb791b51b8790126f60726dc0931f12b9c7
