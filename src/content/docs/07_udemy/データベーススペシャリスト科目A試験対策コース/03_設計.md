---
title: 03_設計
---

# 設計

## E-R図（Entity - Relationship図）

扱うデータ（エンティティ）とその間の関係（リレーションシップ）を図で表現する方法

= 「どんなデータを扱うか」「データ同士がどうつながっているか」を見える化した設計図

### E-R図の構成要素

| 要素                          | 意味             | 表記例    |
| --------------------------- | -------------- | ------ |
| **エンティティ（Entity）**          | 管理したい対象（モノやコト） | 四角形で表す |
| **属性（Attribute）**           | エンティティが持つ性質や情報 | 楕円で表す  |
| **リレーションシップ（Relationship）** | エンティティ同士の関係    | ひし形で表す |

### 1...*などの意味

- *：無限という意。0も含む
- 1...*：1対多という文字を記号化したもの

### 主キー

- 値の重複が無いこと
- 値が空で無いこと

### 外部キー

あるテーブルの列が別のテーブルの主キー（または一意キー）を参照するための制約

データベース内でテーブル同士の「参照関係（親子関係）」を作り、データの整合性を保つために使う

#### 外部キーと外部キー制約の違い

### 候補キー

行を1つに特定できる項目（複数項目も可能）でありかつ極小（= 余計な項目が含まれていない）であること

また、テーブル内で複数設定できる（そのうちの1つを主キーとする）

### （関係的）カーディナリティ

＝多重度

※補足：統計的カーディナリティとは？ → 

### E-R図と、UML、クラス図、オブジェクト図、概念データモデルの違い

- クラス図の中にUMLがある
- E-R図には矢印があるが、UMLには無い

### 連関エンティティ

2つのエンティティが多対多のカーディナリティのときに、2つのエンティティの間に作られるエンティティのこと

連関エンティティをつくることで、列（テーブル定義）の修正回数が減る
← RDBは列の修正はしづらいが、行の修正はしやすいようにできているため、理にかなった構造となる

### 3項関連

3つのエンティティのいずれの2つのエンティティも多対多であること

## 正規化

### 関数従属性

片方の値が変わると、もう片方の値も変わる

例）社員コードが変わると、社員名も変わる

※主キーは他の列全てに対して関数従属性があるといえる
※片方の値が変わってないのに、もう片方の値が変わっている場合は、関数従属性が無い
※片方の値が変わっているのに、もう片方の値が変わっていない場合は、関数従属性がある

#### 部分集合、和集合の意味

Aが変わればCが変わる
Aの一部がB

#### 推移的関数従属性

関数従属性から、さらに関数従属性が成立する

例）社員コードが決まると部署コードが決まり、部署コードが決まると部署名が決まる
= 「社員コード → 部署コード → 部署名」と表記する

※推移的関数従属性が成立する（A → B → C）時には、A → Cも自動的に成立する
※ただし、逆（C → A、C → B、B → A など）はいずれも成立しない

